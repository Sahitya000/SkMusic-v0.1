<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Resso Clone - Full Functional</title>
  <style>
    :root {
      --primary: #1ed760;
      --secondary: #535353;
      --dark: #121212;
      --light-dark: #212121;
      --text: #ffffff;
      --text-secondary: #b3b3b3;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      background: var(--dark);
      font-family: 'Segoe UI', sans-serif;
      color: var(--text);
      overflow-y: scroll;
      scroll-snap-type: y mandatory;
      height: 100vh;
      touch-action: pan-y;
    }
    
    /* Header/Navbar */
    .header {
      position: fixed;
      top: 0;
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent);
      z-index: 100;
    }
    
    .logo {
      font-size: 24px;
      font-weight: bold;
      color: var(--primary);
    }
    
    .search-icon, .user-icon {
      font-size: 20px;
      color: var(--text);
      cursor: pointer;
    }
    
    /* Search Modal */
    .search-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--dark);
      z-index: 200;
      padding: 70px 20px 20px;
      display: none;
      overflow-y: auto;
    }
    
    .search-container {
      width: 100%;
      position: sticky;
      top: 0;
      background: var(--dark);
      padding-bottom: 10px;
    }
    
    .search-input {
      width: 100%;
      padding: 15px;
      font-size: 16px;
      border-radius: 25px;
      border: none;
      background: var(--light-dark);
      color: var(--text);
      margin-bottom: 10px;
    }
    
    .close-search {
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 24px;
      color: var(--text);
      cursor: pointer;
    }
    
    /* Main Content */
    .container {
      padding-top: 60px;
    }
    
    /* Song Cards */
    .song {
      height: 100vh;
      scroll-snap-align: start;
      position: relative;
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 20px;
    }
    
    .overlay {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.9), rgba(0,0,0,0.4));
      z-index: 1;
    }
    
    .song-info {
      position: relative;
      z-index: 2;
      margin-bottom: 30px;
    }
    
    .song-title {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 10px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .song-artist {
      font-size: 16px;
      color: var(--text-secondary);
    }
    
    /* Lyrics Section */
    .lyrics-container {
      position: relative;
      z-index: 2;
      height: 40%;
      overflow-y: auto;
      padding: 15px;
      background: rgba(0,0,0,0.3);
      border-radius: 12px;
      margin-bottom: 20px;
      scrollbar-width: none; /* Firefox */
    }
    
    .lyrics-container::-webkit-scrollbar {
      display: none; /* Chrome/Safari */
    }
    
    .lyrics {
      font-size: 18px;
      line-height: 1.6;
      text-align: center;
      color: var(--text);
    }
    
    .lyrics-line {
      margin-bottom: 15px;
      opacity: 0.6;
      transition: all 0.3s ease;
    }
    
    .lyrics-line.active {
      opacity: 1;
      font-size: 20px;
      color: var(--primary);
      font-weight: bold;
    }
    
    /* Player Controls */
    .player-controls {
      position: relative;
      z-index: 2;
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
    }
    
    .progress-container {
      width: 100%;
      margin-bottom: 20px;
    }
    
    .progress-bar {
      width: 100%;
      height: 4px;
      background: var(--secondary);
      border-radius: 2px;
      margin-bottom: 5px;
      overflow: hidden;
      position: relative;
      cursor: pointer;
    }
    
    .progress {
      height: 100%;
      background: var(--primary);
      width: 0%;
      position: relative;
    }
    
    .progress-handle {
      position: absolute;
      right: -6px;
      top: 50%;
      transform: translateY(-50%);
      width: 12px;
      height: 12px;
      background: var(--primary);
      border-radius: 50%;
      opacity: 0;
      transition: opacity 0.2s;
    }
    
    .progress-bar:hover .progress-handle {
      opacity: 1;
    }
    
    .time {
      display: flex;
      justify-content: space-between;
      width: 100%;
      font-size: 12px;
      color: var(--text-secondary);
    }
    
    .controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0 20px;
    }
    
    .control-btn {
      background: none;
      border: none;
      color: var(--text);
      font-size: 20px;
      cursor: pointer;
      padding: 10px;
    }
    
    .play-btn {
      background: var(--primary);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 24px;
      cursor: pointer;
      border: none;
      color: black;
    }
    
    /* Bottom Navigation */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      width: 100%;
      display: flex;
      justify-content: space-around;
      padding: 15px 0;
      background: var(--light-dark);
      z-index: 100;
    }
    
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      color: var(--text-secondary);
      font-size: 12px;
      cursor: pointer;
    }
    
    .nav-item.active {
      color: var(--primary);
    }
    
    .nav-icon {
      font-size: 20px;
      margin-bottom: 5px;
    }
    
    /* Floating Action Buttons */
    .fab {
      position: fixed;
      right: 20px;
      bottom: 80px;
      background: var(--primary);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 20px;
      color: white;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      z-index: 101;
      cursor: pointer;
    }
    
    /* Comments Section */
    .comments-btn {
      position: fixed;
      left: 20px;
      bottom: 80px;
      background: rgba(255,255,255,0.1);
      padding: 10px 15px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      font-size: 14px;
      z-index: 101;
      cursor: pointer;
    }
    
    .comments-icon {
      margin-right: 5px;
    }
    
    /* Loading Spinner */
    .loader {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      border: 5px solid var(--secondary);
      border-top: 5px solid var(--primary);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      z-index: 1000;
    }
    
    @keyframes spin {
      0% { transform: translate(-50%, -50%) rotate(0deg); }
      100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    
    /* Hidden YouTube Player */
    #youtube-player {
      position: absolute;
      width: 0;
      height: 0;
      opacity: 0;
    }
  </style>
</head>
<body>

  <div class="header">
    <div class="logo">SkMusic</div>
    <div class="search-icon" onclick="openSearch()">üîç</div>
    <div class="user-icon">üë§</div>
  </div>

  <div class="search-modal" id="searchModal">
    <div class="close-search" onclick="closeSearch()">‚úï</div>
    <div class="search-container">
      <input type="text" class="search-input" id="searchInput" placeholder="Search for songs, artists..." onkeypress="handleSearchKeyPress(event)">
    </div>
    <div id="searchResults"></div>
  </div>

  <div class="loader" id="loader"></div>

  <div class="container" id="results">
    <!-- Default content will be replaced by search results -->
    <div class="song" style="background-image: url('https://i.ytimg.com/vi/JGwWNGJdvx8/maxresdefault.jpg')">
      <div class="overlay"></div>
      
      <div class="song-info">
        <h1 class="song-title">Welcome to Resso</h1>
        <p class="song-artist">Search for music to begin</p>
      </div>
      
      <div class="lyrics-container">
        <div class="lyrics">
          <div class="lyrics-line">Search for your favorite songs</div>
          <div class="lyrics-line">See synchronized lyrics</div>
          <div class="lyrics-line active">Enjoy the music experience</div>
        </div>
      </div>
      
      <div class="player-controls">
        <div class="progress-container">
          <div class="progress-bar">
            <div class="progress"></div>
          </div>
          <div class="time">
            <span>0:00</span>
            <span>0:00</span>
          </div>
        </div>
        
        <div class="controls">
          <button class="control-btn">üîÄ</button>
          <button class="control-btn">‚èÆ</button>
          <button class="play-btn">‚ñ∂</button>
          <button class="control-btn">‚è≠</button>
          <button class="control-btn">üîÅ</button>
        </div>
      </div>
    </div>
  </div>
  
  <div class="fab">+</div>
  <div class="comments-btn">
    <span class="comments-icon">üí¨</span>
    <span>Comments</span>
  </div>
  
  <div class="bottom-nav">
    <div class="nav-item active" onclick="switchTab('home')">
      <div class="nav-icon">üè†</div>
      <div>Home</div>
    </div>
    <div class="nav-item" onclick="switchTab('search')">
      <div class="nav-icon">üîç</div>
      <div>Search</div>
    </div>
    <div class="nav-item" onclick="switchTab('library')">
      <div class="nav-icon">üìª</div>
      <div>Library</div>
    </div>
    <div class="nav-item" onclick="switchTab('settings')">
      <div class="nav-icon">‚öôÔ∏è</div>
      <div>Settings</div>
    </div>
  </div>

  <!-- YouTube IFrame Player -->
  <div id="youtube-player"></div>

  <script>
    // Replace with your actual YouTube API key
    const API_KEY = 'AIzaSyAz3LnhWy_Ciz6I74NvUVfb3J4XSj8Jw_M';
    let player;
    let currentVideoId = '';
    let currentVideoIndex = 0;
    let searchResults = [];
    let lyrics = [];
    let currentLyricIndex = 0;
    let isPlaying = false;
    let progressInterval;
    let touchStartY = 0;
    
    // DOM Elements
    const searchModal = document.getElementById('searchModal');
    const searchInput = document.getElementById('searchInput');
    const searchResultsDiv = document.getElementById('searchResults');
    const resultsContainer = document.getElementById('results');
    const loader = document.getElementById('loader');
    
    // Initialize the app when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      // Load YouTube IFrame API
      loadYouTubeAPI();
      
      // Set up touch events for swipe navigation
      document.addEventListener('touchstart', handleTouchStart, false);
      document.addEventListener('touchend', handleTouchEnd, false);
      
      // For demo purposes, search for popular music initially
      // searchYouTube('popular songs 2023');
    });
    
    // Load YouTube IFrame API
    function loadYouTubeAPI() {
      const tag = document.createElement('script');
      tag.src = "https://www.youtube.com/iframe_api";
      const firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
    }
    
    // YouTube API ready callback
    function onYouTubeIframeAPIReady() {
      player = new YT.Player('youtube-player', {
        height: '0',
        width: '0',
        events: {
          'onReady': onPlayerReady,
          'onStateChange': onPlayerStateChange
        }
      });
    }
    
    function onPlayerReady(event) {
      console.log('YouTube player ready');
    }
    
    function onPlayerStateChange(event) {
      const timeDisplay = document.querySelector('.time');
      const progressBar = document.querySelector('.progress');
      const playBtn = document.querySelector('.play-btn');
      
      switch(event.data) {
        case YT.PlayerState.PLAYING:
          isPlaying = true;
          playBtn.textContent = '‚ùö‚ùö';
          startProgressTracking();
          startLyricsTracking();
          break;
          
        case YT.PlayerState.PAUSED:
          isPlaying = false;
          playBtn.textContent = '‚ñ∂';
          clearInterval(progressInterval);
          break;
          
        case YT.PlayerState.ENDED:
          isPlaying = false;
          playBtn.textContent = '‚ñ∂';
          clearInterval(progressInterval);
          playNextVideo();
          break;
      }
      
      // Update duration display
      if (event.data === YT.PlayerState.PLAYING || event.data === YT.PlayerState.PAUSED) {
        const duration = player.getDuration();
        timeDisplay.innerHTML = `
          <span>${formatTime(player.getCurrentTime())}</span>
          <span>${formatTime(duration)}</span>
        `;
      }
    }
    
    // Tab management
    function switchTab(tab) {
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });
      event.currentTarget.classList.add('active');
      
      // In a real app, you would load different content for each tab
      console.log(`Switched to ${tab} tab`);
    }
    
    // Search modal functions
    function openSearch() {
      searchModal.style.display = 'block';
      searchInput.focus();
    }
    
    function closeSearch() {
      searchModal.style.display = 'none';
    }
    
    function handleSearchKeyPress(e) {
      if (e.key === 'Enter') {
        const query = searchInput.value.trim();
        if (query) {
          searchYouTube(query);
        }
      }
    }
    
    // YouTube Search API
    function searchYouTube(query) {
      showLoader();
      
      // Clear previous results
      searchResultsDiv.innerHTML = '';
      searchResults = [];
      
      // Make API request
      fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=10&q=${encodeURIComponent(query + ' music')}&type=video&key=${API_KEY}`)
        .then(response => response.json())
        .then(data => {
          hideLoader();
          searchResults = data.items;
          displaySearchResults(data.items);
        })
        .catch(error => {
          hideLoader();
          console.error('Error fetching data:', error);
          searchResultsDiv.innerHTML = '<p style="color: white; text-align: center; padding: 20px;">Error loading results. Please try again.</p>';
        });
    }
    
    function displaySearchResults(items) {
      searchResultsDiv.innerHTML = '';
      
      if (items.length === 0) {
        searchResultsDiv.innerHTML = '<p style="color: white; text-align: center; padding: 20px;">No results found.</p>';
        return;
      }
      
      items.forEach((item, index) => {
        const videoId = item.id.videoId;
        const title = item.snippet.title;
        const channel = item.snippet.channelTitle;
        const thumbnail = item.snippet.thumbnails.medium ? item.snippet.thumbnails.medium.url : item.snippet.thumbnails.default.url;
        
        const resultItem = document.createElement('div');
        resultItem.style.display = 'flex';
        resultItem.style.padding = '10px';
        resultItem.style.marginBottom = '10px';
        resultItem.style.backgroundColor = 'rgba(255,255,255,0.1)';
        resultItem.style.borderRadius = '8px';
        resultItem.style.cursor = 'pointer';
        resultItem.style.alignItems = 'center';
        resultItem.onclick = () => {
          currentVideoIndex = index;
          playVideo(videoId, title, channel, thumbnail);
        };
        
        resultItem.innerHTML = `
          <img src="${thumbnail}" style="width: 80px; height: 60px; border-radius: 4px; margin-right: 10px;">
          <div style="flex: 1; min-width: 0;">
            <div style="font-weight: bold; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${title}</div>
            <div style="font-size: 12px; color: var(--text-secondary);">${channel}</div>
          </div>
        `;
        
        searchResultsDiv.appendChild(resultItem);
      });
    }
    
    // Video playback functions
    function playVideo(videoId, title, artist, thumbnail) {
      currentVideoId = videoId;
      
      // Update the UI
      resultsContainer.innerHTML = '';
      
      const songDiv = document.createElement('div');
      songDiv.className = 'song';
      songDiv.style.backgroundImage = `url(${thumbnail})`;
      
      songDiv.innerHTML = `
        <div class="overlay"></div>
        
        <div class="song-info">
          <h1 class="song-title">${title}</h1>
          <p class="song-artist">${artist}</p>
        </div>
        
        <div class="lyrics-container">
          <div class="lyrics" id="lyricsDisplay">
            <div class="lyrics-line">Loading lyrics...</div>
          </div>
        </div>
        
        <div class="player-controls">
          <div class="progress-container">
            <div class="progress-bar" id="progressBarContainer">
              <div class="progress" id="progressBar"></div>
              <div class="progress-handle"></div>
            </div>
            <div class="time" id="timeDisplay">
              <span>0:00</span>
              <span>0:00</span>
            </div>
          </div>
          
          <div class="controls">
            <button class="control-btn" onclick="toggleShuffle()">üîÄ</button>
            <button class="control-btn" onclick="playPreviousVideo()">‚èÆ</button>
            <button class="play-btn" id="playBtn" onclick="togglePlay()">‚ñ∂</button>
            <button class="control-btn" onclick="playNextVideo()">‚è≠</button>
            <button class="control-btn" onclick="toggleRepeat()">üîÅ</button>
          </div>
        </div>
      `;
      
      resultsContainer.appendChild(songDiv);
      closeSearch();
      
      // Load and play the video
      if (player) {
        player.loadVideoById(videoId);
        player.playVideo();
      }
      
      // Fetch lyrics (simulated - in a real app you'd use a lyrics API)
      fetchLyrics(title, artist);
    }
    
    // Simulated lyrics fetching
    function fetchLyrics(title, artist) {
      // In a real app, you would call a lyrics API here
      console.log(`Fetching lyrics for ${title} by ${artist}`);
      
      // Simulate API delay
      setTimeout(() => {
        // Mock lyrics data
        lyrics = generateMockLyrics();
        currentLyricIndex = 0;
        
        const lyricsDisplay = document.getElementById('lyricsDisplay');
        lyricsDisplay.innerHTML = '';
        
        lyrics.forEach((line, index) => {
          const lineDiv = document.createElement('div');
          lineDiv.className = 'lyrics-line';
          lineDiv.textContent = line.text;
          if (index === 0) lineDiv.classList.add('active');
          lyricsDisplay.appendChild(lineDiv);
        });
      }, 1000);
    }
    
    function generateMockLyrics() {
      // Generate mock lyrics with timestamps
      const lines = [
        "This is the first line of the song",
        "This line comes a bit later",
        "The chorus starts here",
        "Sing it loud, sing it proud",
        "Back to the verse now",
        "The story continues",
        "Building up to the climax",
        "The most powerful part",
        "Coming down slowly",
        "Final words of the song"
      ];
      
      return lines.map((text, i) => ({
        text: t
